–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ GitLab —Å SonarQube –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞, –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –≤–∞—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. –í–æ—Ç –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ:

üîß 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

¬∑ –í–µ—Ä—Å–∏–∏ GitLab: –î–ª—è —Å–∞–º–æ—É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–π GitLab —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è 11.7+ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 15.6+) .
¬∑ –ò–∑–¥–∞–Ω–∏–µ SonarQube: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ –≤–µ—Ç–æ–∫, –¥–µ–∫–æ—Ä–∞—Ü–∏—è merge request) –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ Developer Edition –∏ –≤—ã—à–µ .
¬∑ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è self-signed SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ GitLab, –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ Java –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ SonarQube –∫–æ–º–∞–Ω–¥–æ–π:
  ```bash
  keytool -import -alias GitLabCACert -file /path/to/cert.crt -keystore "$JAVA_HOME/lib/security/cacerts" -storepass changeit
  [citation:5].
  ```

‚öôÔ∏è 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ GitLab OAuth

¬∑ –°–æ–∑–¥–∞–π—Ç–µ OAuth-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ GitLab:
  ¬∑ Redirect URI: –£–∫–∞–∂–∏—Ç–µ https://<sonarqube-url>/oauth2/callback/gitlab (–Ω–∞–ø—Ä–∏–º–µ—Ä, http://myIp:9000/oauth2/callback/gitlab –¥–ª—è HTTP) .
  ¬∑ Scopes: –í—ã–±–µ—Ä–∏—Ç–µ api (–¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≥—Ä—É–ø–ø) –∏–ª–∏ read_user (—Ç–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è) .
¬∑ –í SonarQube (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ > Configuration > General Settings > ALM Integrations > GitLab > Authentication):
  ¬∑ –í–≤–µ–¥–∏—Ç–µ Application ID –∏ Secret –∏–∑ OAuth-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
  ¬∑ –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é Enabled .
¬∑ –í–∞–∂–Ω–æ: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Server Base URL –≤ SonarQube (Administration > General) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–¥–∞–Ω, –∏–Ω–∞—á–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å .

üîó 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ

¬∑ –í SonarQube –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Administration > Configuration > General Settings > ALM Integrations > GitLab.
¬∑ –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  ¬∑ GitLab API URL: –ù–∞–ø—Ä–∏–º–µ—Ä, https://gitlab.example.com/api/v4 .
  ¬∑ Personal Access Token: –¢–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è GitLab —Å –ø—Ä–∞–≤–∞–º–∏ api (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dedicated-–∞–∫–∫–∞—É–Ω—Ç —Å –ø—Ä–∞–≤–∞–º–∏ Reporter) .
¬∑ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ "Could not validate GitLab url", —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç GitLab –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ Java .

üì• 4. –ò–º–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ GitLab –≤ SonarQube

¬∑ –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ SonarQube –Ω–∞–∂–º–∏—Ç–µ Add project > GitLab.
¬∑ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ personal access token —Å scope read_api –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–ø–∏—Å–∫—É –ø—Ä–æ–µ–∫—Ç–æ–≤ .
¬∑ –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–∑ —Å–ø–∏—Å–∫–∞. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–µ–∫–æ—Ä–∞—Ü–∏–∏ merge request –±—É–¥—É—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ .

üõ†Ô∏è 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –≤ GitLab CI/CD

¬∑ –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ GitLab:
  ¬∑ SONAR_TOKEN: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ SonarQube —Ç–æ–∫–µ–Ω –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞.
  ¬∑ SONAR_HOST_URL: URL —Å–µ—Ä–≤–µ—Ä–∞ SonarQube .
¬∑ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .gitlab-ci.yml:
  ```yaml
  sonarqube-check:
    stage: test
    image: sonarsource/sonar-scanner-cli:latest
    variables:
      GIT_DEPTH: 0  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–µ—Ç–æ–∫
    script:
      - sonar-scanner
        -Dsonar.qualitygate.wait=true  # –û–∂–∏–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç Quality Gate
    rules:
      - if: $CI_COMMIT_BRANCH == "main"  # –ê–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ç–∫–∏
      - if: $CI_MERGE_REQUEST_IID  # –ê–Ω–∞–ª–∏–∑ –¥–ª—è merge request
  [citation:2][citation:8].
  ```
¬∑ –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ merge request –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  ```bash
  -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME
  [citation:4].
  ```

üñºÔ∏è 6. –î–µ–∫–æ—Ä–∞—Ü–∏—è Merge Request (Developer Edition+)

¬∑ –î–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Ä—É—á–Ω—É—é:
  ¬∑ Project Settings > General Settings > Pull Request Decoration.
  ¬∑ –£–∫–∞–∂–∏—Ç–µ Configuration name –∏ GitLab Project ID .
¬∑ –î–ª—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤–∫–ª—é—á–∏—Ç–µ Enable mono repository support –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ Analysis Scope .

‚ö†Ô∏è 7. –†–µ—à–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

¬∑ –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Server Base URL –≤ SonarQube –∏ redirect URI –≤ GitLab OAuth .
¬∑ –ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ merge request: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ preview –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–≤—ã–µ issues .
¬∑ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ SONAR_TOKEN –∏ SONAR_HOST_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ GitLab CI .

üíé –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SonarQube —Å GitLab –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞. –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Developer Edition –∏–ª–∏ –≤—ã—à–µ. –î–ª—è –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è Enterprise Edition .

–î–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏) –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ .